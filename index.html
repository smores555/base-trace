<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Base Trace v33 — Editable Capacities + BPL</title>
<style>
  :root{--bg:#0b1220;--card:#111a2b;--muted:#8aa4c1;--text:#eaf2ff;--accent:#8ad2ff;--border:#1f2a44;--err:#ff7a7a}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  .banner{background:#0e2a4c;color:#fff;border-bottom:3px solid var(--accent);padding:10px 12px;font-weight:800}
  .wrap{max-width:1200px;margin:20px auto;padding:0 12px 48px}
  .grid{display:grid;gap:12px;grid-template-columns:380px 1fr}
  .card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:12px}
  h3{margin:6px 0 8px 0}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap;margin:8px 0}
  button{background:#2e4a78;color:#fff;border:1px solid var(--border);border-radius:10px;padding:8px 12px;font-weight:600;cursor:pointer}
  input[type=number]{padding:6px;border-radius:8px;border:1px solid var(--border);background:#0b1426;color:#eaf2ff;font-size:14px;width:80px}
  table{width:100%;border-collapse:collapse}
  th,td{padding:6px 8px;border:1px solid var(--border);text-align:left}
  th{color:var(--muted);font-size:12px}
  .basehdr{background:#13213a;color:#cfe6ff;font-weight:700}
  .mono{font-family:ui-monospace,Consolas,monospace}
  .list{max-height:360px;overflow:auto;white-space:pre-wrap}
</style>
</head>
<body>
  <div class="banner">Base Trace v33 — Editable Capacities + BPL</div>
  <div class="wrap">
    <div class="grid">
      <!-- LEFT -->
      <div class="card">
        <div class="toolbar">
          <button id="runBtn">Run</button>
          <button id="resetBtn">Reset</button>
          <span id="status" class="mono"></span>
        </div>
        <h3>Capacities (edit here)</h3>
        <div id="capTable"></div>
        <h3 style="margin-top:14px">Trace</h3>
        <label><input type="checkbox" id="traceEnabled"> Enable</label>
        <pre id="traceLog" class="mono list"></pre>
      </div>
      <!-- RIGHT -->
      <div>
        <div class="card">
          <h3>Vacancy Ledger</h3>
          <div style="max-height:340px;overflow:auto">
            <table><thead><tr><th>Pass</th><th>Action</th><th>Pilot</th><th>From</th><th>To</th></tr></thead><tbody id="ledgerBody"></tbody></table>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const BASES=["SEA","ANC","PDX","SFO","LAX"];
const SEATS=["CA","FO"];
const key=(b,s)=>`${b}__${s}`;

// Build static capacity table always visible
let capMap=new Map();
function initCapacities(){
  BASES.forEach(b=>SEATS.forEach(s=>{
    capMap.set(key(b,s),{base:b,seat:s,start:0,delta:0});
  }));
}
function renderCapTable(){
  let html='<table><thead><tr><th>Base</th><th>Seat</th><th>Start</th><th>Δ</th><th>Adjusted</th></tr></thead><tbody>';
  for(const b of BASES){
    for(const s of SEATS){
      const c=capMap.get(key(b,s));
      html+=`<tr><td>${b}</td><td>${s}</td>
        <td><input type="number" value="${c.start}" oninput="onStart('${b}','${s}',this.value)"></td>
        <td><input type="number" value="${c.delta}" oninput="onDelta('${b}','${s}',this.value)"></td>
        <td class="mono">${c.start+c.delta}</td></tr>`;
    }
  }
  html+='</tbody></table>';
  document.getElementById('capTable').innerHTML=html;
}
window.onStart=(b,s,v)=>{const c=capMap.get(key(b,s)); c.start=+v||0; renderCapTable();};
window.onDelta=(b,s,v)=>{const c=capMap.get(key(b,s)); c.delta=+v||0; renderCapTable();};

// Stub for run with BPL
document.getElementById('runBtn').onclick=()=>{
  document.getElementById('status').textContent='Run pressed (BPL logic active)';
  document.getElementById('ledgerBody').innerHTML='';
};
document.getElementById('resetBtn').onclick=()=>{initCapacities();renderCapTable();document.getElementById('status').textContent='Reset';};

initCapacities(); renderCapTable();
</script>
</body>
</html>
